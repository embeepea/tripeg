(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function getopt(n,t,e){return n&&void 0!==n[t]?n[t]:e}var animator=module.exports={};require("./requestanimationframe"),animator.Animator=function(n){var t=getopt(n,"frameDelayMS",10),e=getopt(n,"interActionDelayMS",150),i=getopt(n,"draw",function(){}),o=[],a={};return a.add_action=function(n){var r={};r.begin=function(){n.begin(),r.step()},r.step=function(){var e=void 0===n.step||n.step();e?r.end():setTimeout(function(){requestAnimationFrame(function(){i(),r.step()})},t)},r.end=function(){void 0!==n.end&&n.end(),requestAnimationFrame(function(){i(),setTimeout(function(){a.play()},e)})},o.push(r)},a.play=function(){o.length>0&&o.shift().begin()},a.request_draw=function(){requestAnimationFrame(function(){i()})},a};
},{"./requestanimationframe":2}],2:[function(require,module,exports){
!function(){"use strict";for(var n=0,i=["ms","moz","webkit","o"],e=0;e<i.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[i[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[e]+"CancelAnimationFrame"]||window[i[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(i){var e=(new Date).getTime(),a=Math.max(0,16-(e-n)),t=window.setTimeout(function(){i(e+a)},a);return n=e+a,t}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})}();
},{}],3:[function(require,module,exports){
function divvy(i,t){var o,e=Math.floor(i/t),n=i%t,r=[];for(o=0;t>o;++o)r.push(n>o?e+1:e);return r}function makeColors(i){var t,o,e=[],n=divvy(i,3);for(t=0;t<n[0];++t)e.push("#FF0000");for(t=0;t<n[1];++t)e.push("#0000FF");for(t=0;t<n[2];++t)e.push("#FFFF00");var r=[];for(t=0;i>t;++t)o=Math.floor(e.length*Math.random()),r.push(e[o]),e.splice(o,1);return r}function l2dist2(i,t){var o=i[0]-t[0],e=i[1]-t[1];return o*o+e*e}function linear_interpolate(i,t,o){return t+i*(o-t)}var tripeg_graphics=module.exports={},tripeg_logic=require("./tripeg-logic"),animatorLib=require("./animator"),Position=tripeg_logic.Position,Peg=function(i){return obj={},obj.color=i,obj.moving=!1,obj.dest=void 0,obj.interpf=void 0,obj.highlighted=!1,obj.highlight=function(i,t){i?(this.highlighted=!0,this.dest=t):this.highlighted=!1},obj};tripeg_graphics.TripegGraphics=function(i,t){function o(i){return[h[0]+i.j*j-i.i*j/2,h[1]+i.i*m*j]}function e(i,t,o){p.beginPath(),p.arc(i[0],i[1],t,0,2*Math.PI),p.fillStyle=o&&void 0!==o.fillStyle?o.fillStyle:"#000000",p.fill(),o&&o.lineWidth&&(p.lineWidth=o.lineWidth,p.strokeStyle=o&&o.strokeStyle?o.strokeStyle:"#000000",p.strokeStyle="#000000",p.stroke())}function n(i,t,o,n,r){var l=[linear_interpolate(n,i[0],o[0]),linear_interpolate(n,i[1],o[1])];e(l,t,r)}function r(i,t){var o;for(p.beginPath(),p.moveTo(i[0][0],i[0][1]),o=1;o<i.length;++o)p.lineTo(i[o][0],i[o][1]);p.fillStyle=t&&void 0!==t.fillStyle?t.fillStyle:"#000000",p.fill(),p.closePath(),t&&t.lineWidth&&(p.lineWidth=t.lineWidth,p.strokeStyle=t&&t.strokeStyle?t.strokeStyle:"#000000",p.strokeStyle="#000000",p.stroke())}function l(){var i,t,l=.1;if(r(u,{fillStyle:"#FBA16C"}),a.each_position(function(i){c=o(i),e(c,k,{fillStyle:"#000000"})}),t=void 0,a.each_position(function(r){if(i=a.pegs[r.i][r.j],void 0!==i)if(i.moving)t=r;else{var s=i.color;i.highlighted?n(o(r),b,o(i.dest),l,{fillStyle:i.color,strokeStyle:"#000000",lineWidth:3}):e(o(r),b,{fillStyle:s,strokeStyle:"#000000",lineWidth:3})}}),void 0!==t){var i=a.pegs[t.i][t.j];n(o(t),b,o(i.dest),i.interpf,{fillStyle:i.color,strokeStyle:"#000000",lineWidth:3})}}var s,a,g,f,h,u,v,d,p=i,_=0,m=Math.sqrt(3)/2,y=2,j=50*y,b=18*y,S=b*b,k=8*y,M=j-2*b,P=(j-b)/Math.tan(Math.PI/6),w=10,F=10,W=1.5*w*F;return d=animatorLib.Animator({frameDelayMS:w,interActionDelayMS:W,draw:l}),obj={},obj.get_rows=function(){return s},obj.reset=function(){a=tripeg_logic.Board(s);var i=0;a.each_position(function(t){(t.i!==g.i||t.j!==g.j)&&a.insert_peg(t,Peg(v[i++]))}),l()},obj.Move=function(i,t,o){var e=tripeg_logic.Move(i,t,o);e.begin=function(){this.moving_peg=a.pegs[i.i][i.j],this.moving_peg.moving=!0,this.moving_peg.interpf=0,this.moving_peg.dest=o};var n=0;return e.step=function(){return F>n?(n+=1,e.moving_peg.interpf=n/F,!1):!0},e.end=function(){this.moving_peg.moving=!1,a=a.move(this)},e},obj.point_in_triangle=function(i,t){if(t<u[0][1])return!1;if(t>u[1][1])return!1;var o=(t-u[0][1])/(u[1][1]-u[0][1]),e=_+f/2,n=e-o*f/2,r=e+o*f/2;return n>i||i>r?!1:!0},obj.peg_position_under_point=function(i){var t,e,n,r;for(t=0;s>t;++t)if(n=o(Position(t,0)),i[1]>=n[1]-b&&i[1]<=n[1]+b){for(e=0;t>=e;++e)if(r=Position(t,e),a.contains_peg(r)&&(n=o(r),i[0]>=n[0]-b&&i[0]<=n[0]+b))return l2dist2(i,n)<S?r:void 0;return void 0}return void 0},obj.moveToEmpty=function(i){g=i,d.add_action(this.Move(i,void 0,a.get_empty_position())),d.play()},obj.request_draw=function(){d.request_draw()},obj.get_peg=function(i){return a.get_peg(i)},obj.get_empty_position=function(i){return a.get_empty_position(i)},obj.solve=function(i){var t,o,e;if(void 0===i&&(i={}),e=(new Date).getTime(),o=a.solve(),void 0!==i.timelog&&i.timelog((new Date).getTime()-e),void 0===o&&void 0!==i.nosolution)return void i.nosolution();for(t=0;t<o.length;++t){var n=o[t];d.add_action(this.Move(n.jumper,n.jumpee,n.dest))}void 0!==i.done&&d.add_action({begin:i.done}),d.play()},obj.set_rows=function(i){s=i,g=Position(0,0),f=2*P+(s-1)*j,this.canvas_height=2*_+m*f,this.canvas_width=2*_+f,h=[_+f/2,_+P+M-6],u=[[_+f/2,_],[_+f,_+m*f],[_,_+m*f]],v=makeColors(tripeg_logic.BoardContext(s).num_slots()-1)},obj.set_rows(t),obj};
},{"./animator":1,"./tripeg-logic":4}],4:[function(require,module,exports){
var tripeg_logic=module.exports={},Position=tripeg_logic.Position=function(i,t){var o={};return o.i=i,o.j=t,o.toString=function(){return"Pos("+this.i+","+this.j+")"},o.add=function(i){return Position(this.i+i.i,this.j+i.j)},o},Offset=tripeg_logic.Offset=function(i,t){var o={};return o.i=i,o.j=t,o.times=function(i){return Offset(this.i*i,this.j*i)},o.toString=function(){return"Offset("+this.i+","+this.j+")"},o},six_neighbors=tripeg_logic.six_neighbors=[Offset(0,1),Offset(-1,0),Offset(-1,-1),Offset(0,-1),Offset(1,0),Offset(1,1)],Move=tripeg_logic.Move=function(i,t,o){var s={};return s.jumper=i,s.jumpee=t,s.dest=o,s.toString=function(){return"("+this.jumper.i+","+this.jumper.j+") -> ("+this.jumpee.i+","+this.jumpee.j+") -> ("+this.dest.i+","+this.dest.j+")"},s},BoardContext=tripeg_logic.BoardContext=function(i){var t,o,s={};for(s.numRows=i,s.positions=[],t=0;t<s.numRows;++t)for(o=0;t>=o;++o)s.positions.push(Position(t,o));for(s.num_slots=function(){return this.numRows*(this.numRows+1)/2},s.each_position=function(i,t){var o,s=0,e=0;for(o=0;o<this.positions.length;++o)void 0!==t&&(0===s&&(t(e),++e,s=e),--s),i(this.positions[o])},s.position_is_valid=function(i){return i.i>=0&&i.i<this.numRows&&i.j>=0&&i.j<=i.i},s.all_moves=function(i){var t,o,s,e=[];for(t=0;t<six_neighbors.length;++t)o=six_neighbors[t],s=i.add(o.times(2)),this.position_is_valid(s)&&e.push(Move(i,i.add(o),s));return e},s.all_moves_for_position=[],t=0;t<s.numRows;++t)for(s.all_moves_for_position[t]=[],o=0;t>=o;++o)s.all_moves_for_position[t].push(s.all_moves(Position(t,o)));return s},Board=tripeg_logic.Board=function(i){var t,o,s,e={};return s="number"==typeof i?BoardContext(i):i,e.boardContext=s,e.numRows=s.numRows,e.pegs=[],s.each_position(function(i){e.pegs[i.i][i.j]=void 0},function(i){e.pegs[i]=[]}),e.currentPegCount=0,e.insert_peg=function(i,t){this.boardContext.position_is_valid(i)&&(void 0===t&&(t=!0),void 0==this.pegs[i.i]&&(this.pegs[i.i]=[]),void 0===this.pegs[i.i][i.j]&&(this.currentPegCount=this.currentPegCount+1),this.pegs[i.i][i.j]=t)},e.remove_peg=function(i){this.boardContext.position_is_valid(i)&&(void 0!==this.pegs[i.i][i.j]&&(this.currentPegCount=this.currentPegCount-1),this.pegs[i.i][i.j]=void 0)},e.get_peg=function(i){return this.boardContext.position_is_valid(i)&&void 0!==this.pegs[i.i]?this.pegs[i.i][i.j]:void 0},e.contains_peg=function(i){return this.boardContext.position_is_valid(i)&&void 0!==this.pegs[i.i]?void 0!==this.pegs[i.i][i.j]:!1},e.toString=function(){var i=["["];for(t=0;t<this.numRows;++t){for(i.push("["),o=0;t>=o;++o)i.push(this.get_peg(Position(t,o))),t>o&&i.push(",");i.push("]"),t<this.numRows-1&&i.push(",")}return i.push("]"),i.join("")},e.insert_peg_everywhere_except=function(i,t){var o=this;this.each_position(function(s){(i.i!==s.i||i.j!==s.j)&&o.insert_peg(s,t)})},e.move_allowed=function(i){var t=this.contains_peg(i.jumper)&&this.contains_peg(i.jumpee)&&!this.contains_peg(i.dest)&&this.boardContext.position_is_valid(i.dest);return t},e.clone=function(){var i=Board(this.boardContext),t=this;return this.each_position(function(o){t.contains_peg(o)&&i.insert_peg(o,t.get_peg(o))}),i},e.move=function(i){var t=this.clone();return t.insert_peg(i.dest,t.get_peg(i.jumper)),t.remove_peg(i.jumper),void 0!==i.jumpee&&t.remove_peg(i.jumpee),t},e.possible_moves=function(){var i,t=[],o=this;return this.each_position(function(s){var e=o.boardContext.all_moves_for_position[s.i][s.j];for(i=0;i<e.length;++i){var n=e[i];o.move_allowed(n)&&t.push(n)}}),t},e.each_position=function(i,t){this.boardContext.each_position(i,t)},e.get_empty_position=function(){var i,t,o;for(i=0;i<this.numRows;++i)for(t=0;i>=t;++t){var o=Position(i,t);if(!this.contains_peg(o))return o}return void 0},e.solve=function(){var i,t,o;if(1===this.currentPegCount)return[];for(t=this.possible_moves(),i=0;i<t.length;++i)if(o=this.move(t[i]).solve(),void 0!==o)return o.splice(0,0,t[i]),o;return void 0},e};
},{}],5:[function(require,module,exports){
function display_message(e){$("#message").html(e)}function clear_message(){$("#message").html(" ")}function splash_message(e){$("#splash-message").html(e),$("#splash-message-container").show(),setTimeout(function(){$("#splash-message-container").fadeOut(400)},500)}function reset(){$("#thecanvas").attr("width",trGraphics.canvas_width),$("#thecanvas").attr("height",trGraphics.canvas_height),$("#container").css("width",trGraphics.canvas_width+"px"),trGraphics.reset()}function change_rows(e){var i=trGraphics.get_rows();i+=e,i>=minrows&&maxrows>=i&&(trGraphics.set_rows(i),reset()),minrows>=i?$("#minus").prop("disabled",!0):$("#minus").prop("disabled",!1),i>=maxrows?$("#plus").prop("disabled",!0):$("#plus").prop("disabled",!1),display_message(click_a_peg_message),$("#play").prop("disabled",!1),peg_click_allowed=!0}var tripeg_graphics=require("./tripeg-graphics"),peg_click_allowed=!0,maxrows=6,minrows=4,click_a_peg_message="Click a peg to change the initial empty position",highlighted_peg=void 0,highlighted_pos=void 0,trGraphics;$(document).ready(function(){$("#splash-message-container").hide(),trGraphics=tripeg_graphics.TripegGraphics($("#thecanvas")[0].getContext("2d"),5),reset(),display_message(click_a_peg_message),$("#play").click(function(){$(this).find("i");clear_message(),$("#play").prop("disabled",!0),peg_click_allowed=!1,display_message("Thinking..."),setTimeout(function(){trGraphics.solve({done:function(){$("#rotate-left").prop("disabled",!1)},nosolution:function(){splash_message("No solution"),$("#rotate-left").prop("disabled",!1),$("#play").prop("disabled",!1),peg_click_allowed=!0},timelog:function(e){display_message("Solution computed in "+e+" ms")}})},10)}),$("#rotate-left").click(function(){trGraphics.reset(),display_message(click_a_peg_message),$("#play").prop("disabled",!1),$("#rotate-left").prop("disabled",!0),peg_click_allowed=!0}).prop("disabled",!0),$("#plus").click(function(){change_rows(1)}),$("#minus").click(function(){change_rows(-1)}),$("#thecanvas").click(function(){void 0!==highlighted_peg&&(highlighted_peg.highlight(!1),highlighted_peg=void 0,trGraphics.moveToEmpty(highlighted_pos))}),$("#thecanvas").mousemove(function(e){if(peg_click_allowed){var i=!1;if(trGraphics.point_in_triangle(e.offsetX,e.offsetY)){var s=trGraphics.peg_position_under_point([e.offsetX,e.offsetY]);if(s&&(i=!0,highlighted_pos=s,highlighted_peg=trGraphics.get_peg(s),!highlighted_peg.highlighted))return highlighted_peg.highlight(!0,trGraphics.get_empty_position()),$("#thecanvas").css("cursor","pointer"),void trGraphics.request_draw()}i||void 0===highlighted_peg||(highlighted_peg.highlight(!1),highlighted_peg=void 0,$("#thecanvas").css("cursor","default"),trGraphics.request_draw())}})});
},{"./tripeg-graphics":3}]},{},[5])